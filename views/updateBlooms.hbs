<div class="container py-4">
    <section class="header mx-auto text-center">
        <h1>Update Bloom: {{ bloom.plantName }}</h1>
    </section>
    <section class="form-cont">
        <form id="update-form">
            <input hidden id="bloom-id" value="{{ bloom._id }}">
            <div class="form-group my-2">
                <label for="image">Image URL</label>
                <input type="text" name="image" id="image" class="form-control" placeholder="Enter Image URL" value="{{ bloom.image }}">
            </div>
            <div class="form-group my-2">
                <label for="plantName">Plant Name</label>
                <input type="text" name="plantName" id="plantName" class="form-control" placeholder="Enter Plant Name" value="{{ bloom.plantName }}">
            </div>
            <div class="form-group my-2">
                <label for="description">Description</label>
                <textarea name="description" id="description" class="form-control" placeholder="Enter Description">{{ bloom.description }}</textarea>
            </div>
            <div class="form-group my-2">
                <label for="region">Region</label>
                <select multiple name="region" id="region" class="form-control">
                    <option value="Northeast">Northeast</option>
                    <option value="Midwest">Midwest</option>
                    <option value="South">South</option>
                    <option value="West">West</option>
                </select>
            </div>
            <div class="form-group my-2">
                <label for="benefits">Benefits</label>
                <select multiple name="benefits" id="benefits" class="form-control">
                    <option value="attracts pollinators">Attracts Pollinators</option>
                    <option value="deer resistant">Deer Resistant</option>
                </select>
            </div>
            <div class="form-group my-2">
                <label for="growingConditions">Growing Conditions</label>
                <select id="growingConditions" class="form-control">
                    <option value="full sun">Full Sun</option>
                    <option value="partial sun">Partial Sun</option>
                    <option value="full shade">Full Shade</option>
                </select>
            </div>
            <div class="form-group my-2">
                <label for="pricePerSeedPacket">Price Per Seed Packet</label>
                <input type="text" name="pricePerSeedPacket" id="pricePerSeedPacket" class="form-control" placeholder="Enter price per seed packet" value="{{ bloom.pricePerSeedPacket }}">
            </div>
            <div class="form-group my-2">
                <label for="pricePerBareRootPlant">Price Per Bare Root Plant</label>
                <input type="text" name="pricePerBareRootPlant" id="pricePerBareRootPlant" class="form-control" placeholder="Enter price per bare root plant" value="{{ bloom.pricePerBareRootPlant }}">
            </div>
            <input type="submit" value="Submit" class="btn btn-dark">
                        <div class="form-group my-2">
                <button type="button" class="btn btn-secondary" onclick="window.location.href='/dashboard';">Cancel</button>
        </form>
    </section>
</div>


<script>
document.getElementById('update-form').addEventListener('submit', async e => {
    e.preventDefault();
    const formData = {
        id: document.getElementById('bloom-id').value,
        image: document.getElementById('image').value,
        plantName: document.getElementById('plantName').value,
        description: document.getElementById('description').value,
        region: Array.from(document.getElementById('region').selectedOptions).map(option => option.value),
        benefits: Array.from(document.getElementById('benefits').selectedOptions).map(option => option.value),
        growingConditions: document.getElementById('growingConditions').value,
        pricePerSeedPacket: document.getElementById('pricePerSeedPacket').value,
        pricePerBareRootPlant: document.getElementById('pricePerBareRootPlant').value
    };

    try {
        const response = await fetch(`/blooms/${formData.id}`, { 
            method: 'PUT',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(formData)
        });

        if (response.ok) {
            alert('Bloom updated successfully!');
            window.location.href = '/dashboard'; // Redirect
        } else {
            console.error('Failed to submit form:', response.statusText);
            alert('Failed to update bloom: ' + response.statusText);
        }
    } catch(err) {
        console.error('Error submitting update form:', err);
        alert('Error updating bloom: ' + err.message); 
    }
});
</script>

